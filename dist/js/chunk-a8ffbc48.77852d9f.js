(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a8ffbc48"],{"099d":function(t,e,s){"use strict";s("c8a3")},"183a":function(t,e,s){},"19b3":function(t,e,s){},"2e9e":function(t,e,s){"use strict";s("8d43")},"38dd":function(t,e,s){},"414c":function(t,e,s){"use strict";s("183a")},"459c":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"level page-header"},[s("div",{staticClass:"level-left"},[s("page-title",{attrs:{text:t.title}})],1),s("div",{staticClass:"level-right"},[s("button-simple",{staticClass:"level-item",attrs:{icon:"plus",text:t.newEntryLabel},on:{click:function(e){return t.$emit("new-clicked")}}})],1)])},i=[],o=s("5530"),n=s("2f62"),r=s("de40"),l=s("8d07"),c={name:"list-page-header",components:{ButtonSimple:r["a"],PageTitle:l["a"]},props:{title:{type:String,default:""},newEntryLabel:{type:String,default:""}},computed:Object(o["a"])({},Object(n["c"])([])),methods:Object(o["a"])({},Object(n["b"])([])),watch:{}},d=c,p=s("0c7c"),m=Object(p["a"])(d,a,i,!1,null,"bf4864ae",null);e["a"]=m.exports},"56b8":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"task-types page fixed-page"},[s("list-page-header",{attrs:{title:t.$t("task_types.title"),"new-entry-label":t.$t("task_types.new_task_type")},on:{"new-clicked":t.onNewClicked}}),s("task-type-list",{attrs:{entries:t.taskTypes,"is-loading":t.loading.taskTypes||t.loading.departments,"is-error":t.errors.taskTypes||t.errors.departments},on:{"update-priorities":t.updatePriorities,"edit-clicked":t.onEditClicked,"delete-clicked":t.onDeleteClicked}}),s("edit-task-type-modal",{attrs:{active:t.modals.edit,"is-loading":t.loading.edit,"is-error":t.errors.edit,entries:t.taskTypes,"task-type-to-edit":t.taskTypeToEdit},on:{cancel:function(e){t.modals.edit=!1},confirm:t.confirmEditTaskType}}),s("delete-modal",{attrs:{active:t.modals.del,"is-loading":t.loading.del,"is-error":t.errors.del,text:t.deleteText(),"error-text":t.$t("task_types.delete_error")},on:{cancel:function(e){t.modals.del=!1},confirm:t.confirmDeleteTaskType}})],1)},i=[],o=s("5530"),n=(s("159b"),s("b0c0"),s("2f62")),r=s("d359"),l=s("5f48"),c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:{modal:!0,"is-active":t.active}},[s("div",{staticClass:"modal-background",on:{click:function(e){return t.$emit("cancel")}}}),s("div",{staticClass:"modal-content"},[s("div",{staticClass:"box"},[t.isEditing?s("h1",{staticClass:"title"},[t._v(" "+t._s(t.$t("task_types.edit_title"))+" "+t._s(t.taskTypeToEdit.name)+" ")]):s("h1",{staticClass:"title"},[t._v(" "+t._s(t.$t("task_types.new_task_type"))+" ")]),s("form",{on:{submit:function(t){t.preventDefault()}}},[s("text-field",{directives:[{name:"focus",rawName:"v-focus"}],ref:"nameField",attrs:{label:t.$t("task_types.fields.name")},on:{enter:t.confirmClicked},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}}),t.isEditing?t._e():s("combobox",{attrs:{label:t.$t("task_types.fields.dedicated_to"),options:t.dedicatedToOptions},on:{enter:t.confirmClicked},model:{value:t.form.for_shots,callback:function(e){t.$set(t.form,"for_shots",e)},expression:"form.for_shots"}}),s("combobox-boolean",{attrs:{label:t.$t("task_types.fields.allow_timelog")},on:{enter:t.confirmClicked},model:{value:t.form.allow_timelog,callback:function(e){t.$set(t.form,"allow_timelog",e)},expression:"form.allow_timelog"}}),s("combobox-department",{attrs:{label:t.$t("task_types.fields.department")},on:{enter:t.confirmClicked},model:{value:t.form.department_id,callback:function(e){t.$set(t.form,"department_id",e)},expression:"form.department_id"}}),s("color-field",{ref:"colorField",attrs:{label:t.$t("task_types.fields.color")},model:{value:t.form.color,callback:function(e){t.$set(t.form,"color",e)},expression:"form.color"}})],1),s("modal-footer",{attrs:{"error-text":t.$t("task_types.create_error"),"is-loading":t.isLoading,"is-error":t.isError},on:{confirm:t.confirmClicked,cancel:function(e){return t.$emit("cancel")}}})],1)])])},d=[],p=(s("4de4"),s("d3b7"),s("ddb0"),s("d065")),m=s("992f"),u=s("4636"),f=s("5cf5"),h=s("f865"),b=s("d5c9"),k=s("7bf8"),y={name:"edit-task-type-modal",mixins:[p["a"]],components:{Combobox:m["a"],ComboboxBoolean:u["a"],ComboboxDepartment:f["a"],ColorField:h["a"],ModalFooter:b["a"],TextField:k["a"]},props:["active","onConfirmClicked","entries","isLoading","isError","taskTypeToEdit","text"],watch:{taskTypeToEdit:function(){this.taskTypeToEdit&&(this.form={name:this.taskTypeToEdit.name,color:this.taskTypeToEdit.color,for_shots:String(!0===this.taskTypeToEdit.for_shots),allow_timelog:String(!0===this.taskTypeToEdit.allow_timelog),department_id:this.taskTypeToEdit.department_id})}},data:function(){return{form:{name:"",color:"$grey",for_shots:"false",allow_timelog:"false",department_id:null},dedicatedToOptions:[{label:this.$t("assets.title"),value:"false"},{label:this.$t("shots.title"),value:"true"}]}},computed:Object(o["a"])(Object(o["a"])({},Object(n["c"])(["taskTypes","taskTypeStatusOptions","departments"])),{},{isEditing:function(){return this.taskTypeToEdit&&this.taskTypeToEdit.id}}),methods:Object(o["a"])(Object(o["a"])({},Object(n["b"])([])),{},{newPriority:function(t){return"true"===t?this.entries.filter((function(t){return t.for_shots})).length+1:this.entries.filter((function(t){return!t.for_shots})).length+1},confirmClicked:function(){this.isEditing||(this.form.priority=this.newPriority(this.form.for_shots)),this.$emit("confirm",this.form)}})},T=y,_=(s("cc3f"),s("0c7c")),g=Object(_["a"])(T,c,d,!1,null,"2ba4f73c",null),v=g.exports,C=s("459c"),w=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"data-list"},[s("div",{staticClass:"datatable-wrapper"},[s("table",{staticClass:"datatable"},[s("thead",{staticClass:"datatable-head"},[s("tr",[s("th",{staticClass:"department",attrs:{scope:"col"}},[t._v(" "+t._s(t.$t("task_types.fields.department"))+" ")]),s("th",{staticClass:"name",attrs:{scope:"col"}},[t._v(t._s(t.$t("task_types.fields.name")))]),s("th",{staticClass:"allow-timelog",attrs:{scope:"col"}},[t._v(" "+t._s(t.$t("task_types.fields.allow_timelog"))+" ")]),s("th",{staticClass:"actions",attrs:{scope:"col"}})])]),s("draggable",{staticClass:"datatable-body",attrs:{draggable:".tasktype-item",tag:"tbody",sort:!0},on:{end:t.updatePriorityAssets},model:{value:t.assetsItems,callback:function(e){t.assetsItems=e},expression:"assetsItems"}},[s("tr",{staticClass:"datatable-type-header",attrs:{slot:"header"},slot:"header"},[s("th",{attrs:{scope:"rowgroup",colspan:"4"}},[s("span",{staticClass:"datatable-row-header"},[t._v(" "+t._s(t.$t("assets.title"))+" ")])])]),t._l(t.assetsItems,(function(e){return s("tr",{key:e.id,staticClass:"datatable-row tasktype-item"},[s("td",{staticClass:"department"},[t.isEmpty(e.department_id)?t._e():s("department-name",{attrs:{department:t.getDepartments(e.department_id)}})],1),s("task-type-cell",{staticClass:"name",attrs:{"task-type":e}}),s("td",{staticClass:"allow-timelog"},[t._v(" "+t._s(e.allow_timelog?t.$t("main.yes"):t.$t("main.no"))+" ")]),s("row-actions-cell",{attrs:{"taskType-id":e.id},on:{"delete-clicked":function(s){return t.$emit("delete-clicked",e)},"edit-clicked":function(s){return t.$emit("edit-clicked",e)}}})],1)}))],2),s("draggable",{staticClass:"datatable-body",attrs:{draggable:".tasktype-item",tag:"tbody",sort:!0},on:{end:t.updatePriorityShots},model:{value:t.shotsItems,callback:function(e){t.shotsItems=e},expression:"shotsItems"}},[s("tr",{staticClass:"datatable-type-header",attrs:{slot:"header"},slot:"header"},[s("th",{attrs:{scope:"rowgroup",colspan:"4"}},[s("span",{staticClass:"datatable-row-header"},[t._v(" "+t._s(t.$t("shots.title"))+" ")])])]),t._l(t.shotsItems,(function(e){return s("tr",{key:e.id,staticClass:"datatable-row tasktype-item"},[s("td",{staticClass:"department"},[t.isEmpty(e.department_id)?t._e():s("department-name",{attrs:{department:t.getDepartments(e.department_id)}})],1),s("task-type-cell",{staticClass:"name",attrs:{"task-type":e}}),s("td",{staticClass:"allow-timelog"},[t._v(" "+t._s(e.allow_timelog?t.$t("main.yes"):t.$t("main.no"))+" ")]),s("row-actions-cell",{attrs:{"taskType-id":e.id},on:{"delete-clicked":function(s){return t.$emit("delete-clicked",e)},"edit-clicked":function(s){return t.$emit("edit-clicked",e)}}})],1)}))],2)],1)]),s("table-info",{attrs:{"is-loading":t.isLoading,"is-error":t.isError}}),s("p",{staticClass:"has-text-centered nb-task-types"},[t._v(" "+t._s(t.entries.length)+" "+t._s(t.$tc("task_types.number",t.entries.length))+" ")])],1)},$=[],E=s("b76a"),O=s.n(E),x=s("14b2"),j=s("e60b"),D=s("58f5"),S=s("5af2"),L={name:"task-type-list",props:["entries","isLoading","isError"],data:function(){return{assetsItems:[],shotsItems:[]}},components:{draggable:O.a,DepartmentName:S["a"],RowActionsCell:x["a"],TableInfo:j["a"],TaskTypeCell:D["a"]},mounted:function(){},computed:Object(o["a"])(Object(o["a"])({},Object(n["c"])(["getDepartments"])),{},{assetTaskTypes:function(){return this.entries.filter((function(t){return!t.for_shots}))},shotTaskTypes:function(){return this.entries.filter((function(t){return t.for_shots}))}}),methods:Object(o["a"])(Object(o["a"])({},Object(n["b"])([])),{},{updatePriorityAssets:function(){var t=[];this.assetsItems.forEach((function(e,s){s+=1;var a={id:e.id,name:e.name,priority:String(s)};e.priority=s,t.push(a)})),this.$emit("update-priorities",t)},updatePriorityShots:function(){var t=[];this.shotsItems.forEach((function(e,s){s+=1;var a={id:e.id,name:e.name,priority:String(s)};e.priority=s,t.push(a)})),this.$emit("update-priorities",t)},isEmpty:function(t){return void 0===t||null===t||""===t}}),watch:{entries:{immediate:!0,handler:function(){var t=this;setTimeout((function(){t.assetsItems=JSON.parse(JSON.stringify(t.assetTaskTypes)),t.shotsItems=JSON.parse(JSON.stringify(t.shotTaskTypes))}),100)}}}},I=L,F=(s("414c"),Object(_["a"])(I,w,$,!1,null,"99a0235c",null)),P=F.exports,A={name:"task-types",components:{DeleteModal:l["a"],EditTaskTypeModal:v,ListPageHeader:C["a"],TaskTypeList:P},data:function(){return{errors:{taskTypes:!1,departments:!1,edit:!1,del:!1},loading:{taskTypes:!1,departments:!1,edit:!1,del:!1},modals:{del:!1,edit:!1},taskTypeToDelete:{color:"#999999"},taskTypeToEdit:null}},computed:Object(o["a"])({},Object(n["c"])(["getTaskType","taskTypes"])),mounted:function(){var t=this;this.loading.taskTypes=!0,this.errors.taskTypes=!1,this.loading.departments=!0,this.errors.departments=!1,this.loadDepartments().then((function(){t.loading.departments=!1})).catch((function(e){console.error(e),t.loading.departments=!1,t.errors.departments=!0})),this.loadTaskTypes().then((function(){t.loading.taskTypes=!1})).catch((function(e){console.error(e),t.loading.taskTypes=!1,t.errors.taskTypes=!0}))},methods:Object(o["a"])(Object(o["a"])({},Object(n["b"])(["editTaskType","deleteTaskType","loadTaskTypes","loadDepartments"])),{},{confirmEditTaskType:function(t){var e=this,s="newTaskType";this.taskTypeToEdit&&this.taskTypeToEdit.id&&(s="editTaskType",t.id=this.taskTypeToEdit.id),this.loading.edit=!0,this.errors.edit=!1,this.$store.dispatch(s,t).then((function(){e.loading.edit=!1,e.modals.edit=!1})).catch((function(t){console.error(t),e.loading.edit=!1,e.errors.edit=!0}))},updatePriorities:function(t){var e=this;t.forEach((function(t){e.$store.commit("EDIT_TASK_TYPE_END",t)})),this.savePriorities(t)},savePriorities:function(t){var e=this,s=(new Date).getTime();this.lastCall=this.lastCall||0,s-this.lastCall>1e3&&!this.isSaving?(this.lastCall=s,this.isSaving=!0,r["a"].runPromiseMapAsSeries(t,this.editTaskType).then((function(){e.isSaving=!1,e.newSaveCall&&e.savePriorities(t)}))):this.newSaveCall=!0},confirmDeleteTaskType:function(){var t=this;this.loading.del=!0,this.errors.del=!1,this.deleteTaskType(this.taskTypeToDelete).then((function(){t.loading.del=!1,t.modals.del=!1})).catch((function(e){console.error(e),t.loading.del=!1,t.errors.del=!0}))},deleteText:function(){var t=this.taskTypeToDelete;return t?this.$t("task_types.delete_text",{name:t.name}):""},onDeleteClicked:function(t){this.taskTypeToDelete=t,this.modals.del=!0},onEditClicked:function(t){this.taskTypeToEdit=t,this.modals.edit=!0},onNewClicked:function(){this.taskTypeToEdit={color:"#999999"},this.modals.edit=!0}}),watch:{},metaInfo:function(){return{title:"".concat(this.$t("task_types.title")," - Kitsu")}}},B=A,N=Object(_["a"])(B,a,i,!1,null,"68f688be",null);e["default"]=N.exports},"5af2":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("span",{staticClass:"dot",style:{border:"5px solid "+t.color,color:t.color}}),s("span",[t._v(" "+t._s(t.department.name)+" ")])])},i=[],o=s("5530"),n=s("2f62"),r={name:"department-name",components:{},props:{department:{type:Object,default:null}},computed:Object(o["a"])(Object(o["a"])({},Object(n["c"])([])),{},{color:function(){return"#000000"===this.department.color.toUpperCase()?"$grey-strong":this.department.color}}),methods:Object(o["a"])({},Object(n["b"])([]))},l=r,c=(s("eb92"),s("0c7c")),d=Object(c["a"])(l,a,i,!1,null,"50e72f9e",null);e["a"]=d.exports},"5cf5":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"field"},[t.label.length>0?s("label",{staticClass:"label"},[t._v(" "+t._s(t.label)+" ")]):t._e(),s("div",{staticClass:"department-combo"},[s("div",{staticClass:"flexrow",on:{click:t.toggleDepartmentList}},[t.currentDepartment?s("div",{staticClass:"selected-department-line flexrow-item"},[s("department-name",{attrs:{department:t.currentDepartment}})],1):t._e(),s("chevron-down-icon",{staticClass:"down-icon flexrow-item"})],1),t.showDepartmentList?s("div",{ref:"select",staticClass:"select-input"},t._l(t.departmentList,(function(e){return s("div",{key:e.id,staticClass:"department-line",on:{click:function(s){return t.selectDepartment(e)}}},[s("department-name",{attrs:{department:e}})],1)})),0):t._e()]),s("combobox-mask",{attrs:{displayed:t.showDepartmentList},on:{click:t.toggleDepartmentList}})],1)},i=[],o=s("2909"),n=s("5530"),r=(s("99af"),s("2f62")),l=s("0a35"),c=s("dbde"),d=s("5af2"),p={name:"combobox-department",components:{ChevronDownIcon:l["i"],ComboboxMask:c["a"],DepartmentName:d["a"]},data:function(){return{showDepartmentList:!1}},props:{label:{default:"",type:String},value:{default:"",type:String},selectableDepartments:{type:Array,required:!1}},mounted:function(){},computed:Object(n["a"])(Object(n["a"])({},Object(r["c"])(["departmentMap","departments"])),{},{departmentsToTakeAccount:function(){return this.selectableDepartments?this.selectableDepartments:this.departments},departmentList:function(){return[{name:"---",id:null,color:"#000000"}].concat(Object(o["a"])(this.departmentsToTakeAccount))},currentDepartment:function(){return this.value?this.departmentMap.get(this.value):this.departmentList[0]}}),methods:{selectDepartment:function(t){this.$emit("input",t.id),this.showDepartmentList=!1},toggleDepartmentList:function(){this.showDepartmentList=!this.showDepartmentList}}},m=p,u=(s("2e9e"),s("0c7c")),f=Object(u["a"])(m,a,i,!1,null,"01d39316",null);e["a"]=f.exports},"8d43":function(t,e,s){},c8a3:function(t,e,s){},cc3f:function(t,e,s){"use strict";s("19b3")},eb92:function(t,e,s){"use strict";s("38dd")},f865:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v(t._s(t.label))]),s("div",{staticClass:"control colors"},t._l(t.colors,(function(e,a){return s("div",{key:"color-"+a,ref:"color-"+a,refInFor:!0,class:{color:!0,selected:t.value===e},on:{click:function(s){return t.colorChanged(e)}}},[s("span",{style:{background:e}})])})),0)])},i=[],o=s("5530"),n=s("2f62"),r={name:"text-field",props:{label:{default:"",type:String},value:{default:"$grey999",type:String},placeholder:{default:"",type:String},type:{default:"text",type:String},colors:{default:function(){return["#999999","#8D6E63","#43A047","#7CB342","#009688","#9CCC65","#AFB42B","#DCE775","#FFF176","#FFEB3B","#F9A825","#F57C00","#ff5252","#F06292","#AB47BC","#5C6BC0","#1976D2","#039BE5","#42A5F5","#64B5F6","#26C6DA","#78909C"]}}},data:function(){return{selectedColor:"$grey999"}},computed:Object(o["a"])({},Object(n["c"])([])),methods:Object(o["a"])(Object(o["a"])({},Object(n["b"])([])),{},{colorChanged:function(t,e){this.$emit("input",t)}})},l=r,c=(s("099d"),s("0c7c")),d=Object(c["a"])(l,a,i,!1,null,"562b3c5e",null);e["a"]=d.exports}}]);
//# sourceMappingURL=chunk-a8ffbc48.77852d9f.js.map